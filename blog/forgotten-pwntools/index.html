<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="You&amp;rsquo;d think after searching for /bin/sh in libc that many times in pwntools that I&amp;rsquo;d remember the syntax. But actually my brain is too busy remembering when the milk in the fridge expires. Here&amp;rsquo;s a collection of my favorite forgotten syntactic gems for pwntools.
General flat payload = flat({ # pad with garbage to this offset cyclic_find(&amp;#39;amia&amp;#39;): rop.chain() }) custom filler
alphabet = &amp;#39;bcdefhijklmnopqrstuvwyz&amp;#39; # cleansed alphabet payload = fit({ cyclic_find(&amp;#39;nbbb&amp;#39;, alphabet=bet): rop." />
<meta name="keywords" content=", hacking, pentesting, Exploit Development" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://cybernetic.coffee/blog/forgotten-pwntools/" />


    <title>
        
            Forgotten pwntools :: Cybernetic Coffee 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.64cc374c419669695f00d5c55727fea41e0fdc86b9beb1b4d1d1bcf24284f422.css">




<link rel="shortcut icon" href="https://cybernetic.coffee/images/favicon.ico" />


<meta itemprop="name" content="Forgotten pwntools">
<meta itemprop="description" content="You&rsquo;d think after searching for /bin/sh in libc that many times in pwntools that I&rsquo;d remember the syntax. But actually my brain is too busy remembering when the milk in the fridge expires. Here&rsquo;s a collection of my favorite forgotten syntactic gems for pwntools.
General flat payload = flat({ # pad with garbage to this offset cyclic_find(&#39;amia&#39;): rop.chain() }) custom filler
alphabet = &#39;bcdefhijklmnopqrstuvwyz&#39; # cleansed alphabet payload = fit({ cyclic_find(&#39;nbbb&#39;, alphabet=bet): rop."><meta itemprop="datePublished" content="2021-08-24T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-08-24T00:00:00+00:00" />
<meta itemprop="wordCount" content="184">
<meta itemprop="keywords" content="hacking,pentesting,Exploit Development," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Forgotten pwntools"/>
<meta name="twitter:description" content="You&rsquo;d think after searching for /bin/sh in libc that many times in pwntools that I&rsquo;d remember the syntax. But actually my brain is too busy remembering when the milk in the fridge expires. Here&rsquo;s a collection of my favorite forgotten syntactic gems for pwntools.
General flat payload = flat({ # pad with garbage to this offset cyclic_find(&#39;amia&#39;): rop.chain() }) custom filler
alphabet = &#39;bcdefhijklmnopqrstuvwyz&#39; # cleansed alphabet payload = fit({ cyclic_find(&#39;nbbb&#39;, alphabet=bet): rop."/>





    <meta property="article:section" content="Hacking" />

    <meta property="article:section" content="Binary Exploitation" />



    <meta property="article:published_time" content="2021-08-24 00:00:00 &#43;0000 UTC" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <script src="https://kit.fontawesome.com/5eb4842dc5.js" crossorigin="anonymous"></script>

<a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__text">Cybernetic <i class="fas fa-mug-hot"> </i> </span>
            <span class="logo__mark"><i class="fas fa-terminal"></i></span>
            <span class="logo__cursor" style=
                  "
                   background-color:#00ba68;
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://cybernetic.coffee/feed/">Activity Feed</a></li><li><a href="https://cybernetic.coffee/projects/">Projects</a></li><li><a href="https://cybernetic.coffee/blog">Blog</a></li><li><a href="https://cybernetic.coffee/ctf">CTF</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">
        
        <div class="post-info">
            <p>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                
                    2021-08-24 10:00
                

                
            </p>
        </div>
        

        <article>
            <h2 class="post-title"><a href="https://cybernetic.coffee/blog/forgotten-pwntools/">Forgotten pwntools</a></h2>

            

            
            <div class="post-info">

                <div class="sharing-buttons">
                    








<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fcybernetic.coffee%2fblog%2fforgotten-pwntools%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>



































<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fcybernetic.coffee%2fblog%2fforgotten-pwntools%2f&amp;resubmit=true&amp;title=Forgotten%20pwntools" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


















<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fcybernetic.coffee%2fblog%2fforgotten-pwntools%2f&amp;t=Forgotten%20pwntools" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>









                </div>
            </div>
            

            <hr />

            
                
                <aside id="toc">
                
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#general">General</a>
      <ul>
        <li><a href="#flat"><code>flat</code></a></li>
        <li><a href="#logging"><code>logging</code></a></li>
        <li><a href="#sections"><code>sections</code></a></li>
        <li><a href="#rebase"><code>rebase</code></a></li>
        <li><a href="#unpacking"><code>unpacking</code></a></li>
      </ul>
    </li>
    <li><a href="#rop">ROP</a>
      <ul>
        <li><a href="#raw"><code>raw</code></a></li>
        <li><a href="#libcsearch"><code>libc.search</code></a></li>
        <li><a href="#call"><code>call</code></a></li>
        <li><a href="#function"><code>function</code></a></li>
      </ul>
    </li>
    <li><a href="#format-strings">Format Strings</a>
      <ul>
        <li><a href="#fmtstr_payload"><code>fmtstr_payload</code></a></li>
      </ul>
    </li>
  </ul>
</nav>
                </aside>
                
            

            

            <div class="post-content">
                <p>You&rsquo;d think after searching for <code>/bin/sh</code> in libc that many times in <code>pwntools</code> that I&rsquo;d remember the syntax. But actually my brain is too busy remembering when the milk in the fridge expires. Here&rsquo;s a collection of my favorite forgotten syntactic gems for <code>pwntools</code>.</p>
<h2 id="general">General</h2>
<h3 id="flat"><code>flat</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">payload <span style="color:#f92672">=</span> flat({
    <span style="color:#75715e"># pad with garbage to this offset</span>
    cyclic_find(<span style="color:#e6db74">&#39;amia&#39;</span>): rop<span style="color:#f92672">.</span>chain()
})
</code></pre></div><p><strong>custom filler</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">alphabet <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bcdefhijklmnopqrstuvwyz&#39;</span>     <span style="color:#75715e"># cleansed alphabet</span>

payload <span style="color:#f92672">=</span> fit({
    cyclic_find(<span style="color:#e6db74">&#39;nbbb&#39;</span>, alphabet<span style="color:#f92672">=</span>bet): rop<span style="color:#f92672">.</span>chain()
}, filler<span style="color:#f92672">=</span>alphabet)
</code></pre></div><h3 id="logging"><code>logging</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">log<span style="color:#f92672">.</span>info(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Data section @ </span><span style="color:#e6db74">{</span>data_section<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
log<span style="color:#f92672">.</span>success(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Leaked libc system @ </span><span style="color:#e6db74">{</span>libc_system_addr<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</code></pre></div><h3 id="sections"><code>sections</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data_section <span style="color:#f92672">=</span> elf<span style="color:#f92672">.</span>symbols<span style="color:#f92672">.</span>data_start
</code></pre></div><h3 id="rebase"><code>rebase</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> leaked_setbuf_libc <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74">&#39;setbuf&#39;</span>]
elf<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> leaked_menu_address <span style="color:#f92672">-</span> elf<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74">&#39;menu&#39;</span>]

<span style="color:#75715e"># now we have defeated PIE/ASLR globally</span>
</code></pre></div><h3 id="unpacking"><code>unpacking</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">leak_addr <span style="color:#f92672">=</span> u32(proc<span style="color:#f92672">.</span>recvline(keepends<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)[:<span style="color:#ae81ff">4</span>])
</code></pre></div><h2 id="rop">ROP</h2>
<h3 id="raw"><code>raw</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">rop <span style="color:#f92672">=</span> ROP(binary)

rop<span style="color:#f92672">.</span>raw([
    pop_eax_edx,
    <span style="color:#e6db74">&#39;flag&#39;</span>,
    <span style="color:#ae81ff">0x0</span>
])

</code></pre></div><h3 id="libcsearch"><code>libc.search</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#39;&lt;some-libc&gt;.so&#39;</span>)

<span style="color:#75715e"># Its an iterator guys</span>
next(libc<span style="color:#f92672">.</span>search(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;/bin/sh&#39;</span>))
</code></pre></div><h3 id="call"><code>call</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">rop <span style="color:#f92672">=</span> ROP(<span style="color:#e6db74">&#39;&lt;some-libc&gt;.so&#39;</span>)

rop<span style="color:#f92672">.</span>call(libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74">&#39;system&#39;</span>], [next(libc<span style="color:#f92672">.</span>search(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;/bin/sh&#39;</span>))])
</code></pre></div><h3 id="function"><code>function</code></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">rop <span style="color:#f92672">=</span> ROP(binary)

<span style="color:#75715e"># call function in symbols table with args</span>
rop<span style="color:#f92672">.</span>some_function(arg1, arg2)
</code></pre></div><h2 id="format-strings">Format Strings</h2>
<h3 id="fmtstr_payload"><code>fmtstr_payload</code></h3>
<p><em>Note: this function often writes too much data corrupting the stack, stay tuned for a post on writing your own more reliable function.</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">payload <span style="color:#f92672">=</span> fmtstr_payload(bytes_offset, {target_addr: addr_val}, numbwritten<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, write_size<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;byte&#39;</span>)
</code></pre></div>
            </div>
        </article>

        <hr />

        
        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://cybernetic.coffee/tags/hacking/">hacking</a></span>
        <span class="tag"><a href="https://cybernetic.coffee/tags/pentesting/">pentesting</a></span>
        <span class="tag"><a href="https://cybernetic.coffee/tags/exploit-development/">Exploit Development</a></span>
        
    </p>



            <p>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                184 Words
            </p>
  		</div>
        


        
            
                <div class="pagination">
                    <div class="pagination__title">
                        <span class="pagination__title-h"></span>

                    </div>

                    <div class="pagination__buttons">
                        

                        
                            <span class="button next">
                              <a href="https://cybernetic.coffee/blog/basic-stack-based-overflows/">
                                <span class="button__text">Basic Stack Based Overflows</span>
                                <span class="button__icon">â†’</span>
                              </a>
                            </span>
                        
                    </div>
                </div>
            
        

    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Hacked together with &#10084; by <a href="https://github.com/Angus-C-git">Angus C</a> <i class='fas fa-ghost'></i> </span>
          </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.549d9d8402283235466245c699b04a81b6fb2c75fc03669ba95af9f5e8ad22ab134f177abab9e431efc3441fe5921fd3fb3f8bf50f66dffbdce9eb7994ef69dc.js" integrity="sha512-VJ2dhAIoMjVGYkXGmbBKgbb7LHX8A2abqVr59eitIqsTTxd6urnkMe/DRB/lkh/T&#43;z&#43;L9Q9m3/vc6et5lO9p3A=="></script>



    </body>
</html>
